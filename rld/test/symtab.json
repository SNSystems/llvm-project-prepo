// RUN: rm -rf %t && mkdir -p %t
// RUN: pstore-import %t/db.db %s
// RUN: repo-create-ticket --repo %t/db.db -o %t/t0.o 10000000000000000000000000000000
// RUN: repo-create-ticket --repo %t/db.db -o %t/t1.o 20000000000000000000000000000000
// RUN: rld --repo=%t/db.db -o %t/rld.out %t/t0.o %t/t1.o
// RUN: llvm-readelf --symbols %t/rld.out | FileCheck %s

// CHECK: Symbol table '.symtab' contains 5 entries:
// CHECK-NEXT: Num: Value     Size Type   Bind   Vis     Ndx              Name
// CHECK: 0: 0000000000000000 0    NOTYPE LOCAL  DEFAULT UND
// CHECK: 1: {{[0-9A-Fa-f]+}} 0    FUNC   LOCAL  DEFAULT {{[0-9A-Fa-f]+}} a
// CHECK: 2: {{[0-9A-Fa-f]+}} 0    FUNC   LOCAL  DEFAULT {{[0-9A-Fa-f]+}} c
// CHECK: 3: {{[0-9A-Fa-f]+}} 0    FUNC   GLOBAL DEFAULT {{[0-9A-Fa-f]+}} b
// CHECK: 4: {{[0-9A-Fa-f]+}} 0    FUNC   GLOBAL DEFAULT {{[0-9A-Fa-f]+}} d

{
  "version": 1,
  "id": "04e34316-0810-48ee-862d-4af51ae3c594",
  "transactions": [
    {
      "names": [
        "x86_64-pc-linux-gnu-repo", // 0
        "a", // 1
        "b", // 2
        "c", // 3
        "d", // 4
      ],
      "fragments":{
        "10000000000000000000000000000000": { "text": { "align": 1, "data": "VUiJ5bgrAAAAXcM=" } },
      },
      "compilations":{
        "10000000000000000000000000000000": {
          "triple": 0, //"x86_64-pc-linux-gnu-repo"
          "definitions": [
            {"digest": "10000000000000000000000000000000", "name": 1, "linkage": "internal"}, //"a"
            {"digest": "10000000000000000000000000000000", "name": 2, "linkage": "external"}, //"b"
          ]
        },
        "20000000000000000000000000000000": {
          "triple": 0, //"x86_64-pc-linux-gnu-repo"
          "definitions": [
            {"digest": "10000000000000000000000000000000", "name": 3, "linkage": "internal"}, //"c"
            {"digest": "10000000000000000000000000000000", "name": 4, "linkage": "external"}, //"d"
          ]
        },
      }
    },
  ]
}
