// Check the weak symbol binding: the output symbol is global if one or more of the references to it are strong.
//
// RUN: rm -rf %t && mkdir -p %t
// RUN: pstore-import %t/db.db %s
// RUN: repo-create-ticket --repo %t/db.db -o %t/t.o e865ac76298a3007c24cad11885532d4
// RUN: repo2obj %t/t.o --repo=%t/db.db -o %t/t.elf
// RUN: llvm-readobj --symbols %t/t.elf | FileCheck %s

// CHECK:    Name: _ZTH1a (8)
// CHECK-NEXT:    Value: 0x0
// CHECK-NEXT:    Size: 0
// CHECK-NEXT:    Binding: Global (0x1)
// CHECK-NEXT:    Type: None (0x0)
// CHECK-NEXT:    Other: 0
// CHECK-NEXT:    Section: Undefined (0x0)

{
  "version":1,
  "id":"ea3cc7c1-c2a6-4d91-a0c3-eae84ba60d12",
  "transactions":[
    {
      // generation 1
      "names":[
        "x86_64-pc-linux-gnu-repo",
        "/path",
        "a",
        "_ZTW1a",
        "_ZTH1a"
      ],
      "fragments":{
        "38ba192db4955408af33b70221a5c1b2":{
            "text":{
              "align":16,
              "data":"ULgAAAAASIXAdAXoAAAAAGRIiwQlAAAAAEgDBQAAAABZww==",
              "xfixups":[
                {"name":4,"type":10,"is_weak":false,"offset":2,"addend":0}, //"_ZTH1a"
                {"name":4,"type":4,"is_weak":true,"offset":12,"addend":-4}, //"_ZTH1a"
                {"name":2,"type":22,"offset":28,"addend":-4} //"a"
              ]
            }
          }
      },
      "compilations":{
        "e865ac76298a3007c24cad11885532d4":{
          "path":1, //"/path"
          "triple":0, //"x86_64-pc-linux-gnu-repo"
          "definitions":[
            {"digest":"38ba192db4955408af33b70221a5c1b2","name":3,"linkage":"link_once_odr","visibility":"hidden"} //"_ZTW1a"
          ]
        }
      }
    }
  ]
}
